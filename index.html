<!DOCTYPE html>
<html><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#1a1a2e">
<title>World Explorer 3D</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&family=Orbitron:wght@500;700;900&family=Righteous&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#f5f7fa;overflow:hidden;font-family:'Inter',sans-serif;-webkit-user-select:none;user-select:none;touch-action:pan-x pan-y;-webkit-tap-highlight-color:transparent}
button,input,select,textarea{-webkit-tap-highlight-color:transparent}
input,textarea{-webkit-user-select:text;user-select:text}

/* Title Screen */
#titleScreen{position:fixed;inset:0;background:#000 url('title-bg.jpg') center center/cover no-repeat;display:flex;flex-direction:column;align-items:center;justify-content:center;padding-top:max(24px,calc(env(safe-area-inset-top) + 10px));padding-right:12px;padding-bottom:max(24px,calc(env(safe-area-inset-bottom) + 12px));padding-left:12px;gap:clamp(10px,1.5vh,16px);z-index:200;overflow-y:auto;overflow-x:hidden;isolation:isolate}
#titleScreen::before{content:'';position:absolute;inset:0;background:rgba(0,0,0,0.35);backdrop-filter:blur(1px);pointer-events:none;z-index:0}
#titleScreen.hidden{display:none}
.logo{font-family:'Orbitron',sans-serif;font-size:clamp(36px, 8vw, 72px);font-weight:900;line-height:1.05;color:#ffffff;letter-spacing:clamp(3px, 1vw, 8px);text-transform:uppercase;text-shadow:0 0 30px rgba(83,52,131,0.8),0 0 60px rgba(15,52,96,0.6),0 4px 20px rgba(0,0,0,0.4);position:relative;z-index:1;margin:0;animation:titleGlow 3s ease-in-out infinite;text-align:center;padding:0 20px;flex-shrink:0}
@keyframes titleGlow{0%,100%{text-shadow:0 0 30px rgba(83,52,131,0.8),0 0 60px rgba(15,52,96,0.6),0 4px 20px rgba(0,0,0,0.4)}50%{text-shadow:0 0 40px rgba(83,52,131,1),0 0 80px rgba(15,52,96,0.8),0 4px 30px rgba(0,0,0,0.5)}}
.sub{font-family:'Righteous',cursive;font-size:clamp(13px,1.7vw,20px);line-height:1.25;color:rgba(255,255,255,0.9);letter-spacing:clamp(1px,0.45vw,4px);margin:0;font-weight:400;text-shadow:0 2px 10px rgba(0,0,0,0.35);position:relative;z-index:1;text-align:center;max-width:min(94vw,1100px);padding:0 8px;flex-shrink:0}

/* Menu Container with Tabs */
.menu-container{background:rgba(255,255,255,0.85);backdrop-filter:blur(20px);border:2px solid rgba(255,255,255,0.3);border-radius:20px;width:min(640px,95vw);max-height:calc(100dvh - 170px);display:flex;flex-direction:column;box-shadow:0 30px 80px rgba(0,0,0,0.4),0 0 40px rgba(83,52,131,0.3);position:relative;z-index:1;flex:0 1 auto}
.tab-nav{display:flex;border-bottom:2px solid rgba(232,238,245,0.5);flex-shrink:0;background:rgba(248,250,252,0.6);backdrop-filter:blur(10px);border-radius:18px 18px 0 0}
.tab-btn{flex:1;background:transparent;border:none;padding:16px;font-family:'Inter',sans-serif;font-size:13px;font-weight:500;color:#64748b;cursor:pointer;transition:all 0.3s;position:relative}
.tab-btn:hover{color:#475569;background:rgba(241,245,249,0.6)}
.tab-btn.active{color:#667eea;background:rgba(255,255,255,0.8)}
.tab-btn.active::after{content:'';position:absolute;bottom:-2px;left:0;right:0;height:2px;background:#667eea}
.tab-content{display:none;padding:24px;overflow-y:auto;flex:1;background:rgba(255,255,255,0.3)}
.tab-content.active{display:block}

/* Location Grid */
.loc-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
.loc-grid.custom-centered{grid-template-columns:1fr;max-width:300px;margin:0 auto}
.launch-switch-row{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px;margin-bottom:14px}
.launch-switch-btn{background:rgba(248,250,252,0.9);border:2px solid rgba(226,232,240,0.9);border-radius:10px;padding:10px 12px;font-family:'Poppins',sans-serif;font-size:12px;font-weight:600;color:#475569;cursor:pointer;transition:all 0.2s;min-height:44px}
.launch-switch-btn:hover{border-color:#cbd5e1;background:#f1f5f9}
.launch-switch-btn.active{border-color:#667eea;background:#f0f4ff;color:#3b5bdb;box-shadow:0 4px 12px rgba(102,126,234,0.15)}
.loc{background:rgba(248,250,252,0.9);border:2px solid rgba(226,232,240,0.8);border-radius:12px;padding:16px;cursor:pointer;text-align:center;transition:all 0.2s}
.loc:hover{border-color:rgba(203,213,225,0.9);background:rgba(241,245,249,0.95);transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.08)}
.loc.sel{border-color:rgba(102,126,234,0.8);background:rgba(240,244,255,0.9);box-shadow:0 4px 12px rgba(102,126,234,0.2)}
.loc-name{color:#1e293b;font-family:'Poppins',sans-serif;font-size:14px;font-weight:600;margin-bottom:4px}
.loc-region{color:#64748b;font-size:12px}
.loc.custom{border-color:rgba(245,158,11,0.8);background:rgba(255,251,235,0.9)}
.loc.custom:hover{border-color:rgba(217,119,6,0.9);background:rgba(254,243,199,0.95)}
.loc.custom.sel{border-color:rgba(245,158,11,0.9);background:rgba(254,243,199,0.95);box-shadow:0 4px 12px rgba(245,158,11,0.2)}
.loc.custom .loc-name{color:#92400e}

/* Custom Location Panel */
#customPanel{display:none;margin-top:16px;padding:20px;background:rgba(255,251,235,0.9);border:2px solid rgba(252,211,77,0.8);border-radius:12px;max-height:60vh;overflow-y:auto;backdrop-filter:blur(10px)}
#customPanel.show{display:block}
.custom-title{font-family:'Poppins',sans-serif;font-size:14px;font-weight:600;color:#92400e;margin-bottom:16px;text-align:center}
.custom-row{margin-bottom:14px}
.custom-row label{display:block;font-size:12px;font-weight:500;color:#78716c;margin-bottom:8px}
.search-row{display:flex;gap:10px}
.search-row input{flex:1;background:#ffffff;border:2px solid #e5e7eb;border-radius:8px;padding:12px;color:#1f2937;font-size:14px;font-family:'Inter',sans-serif}
.search-row input:focus{outline:none;border-color:#f59e0b;box-shadow:0 0 0 3px rgba(245,158,11,0.1)}
.search-btn{background:#f59e0b;border:none;border-radius:8px;padding:12px 18px;color:#ffffff;font-weight:600;cursor:pointer;transition:all 0.2s}
.search-btn:hover{background:#d97706;transform:translateY(-1px);box-shadow:0 4px 12px rgba(245,158,11,0.3)}
#searchStatus{font-size:11px;margin-top:8px;min-height:16px;color:#6b7280}
#searchStatus.success{color:#059669}
#searchStatus.error{color:#dc2626}
.divider{text-align:center;margin:16px 0;position:relative}
.divider::before{content:'';position:absolute;left:0;right:0;top:50%;height:1px;background:#e5e7eb}
.divider span{background:#fffbeb;padding:0 12px;position:relative;color:#9ca3af;font-size:12px}
.coords-row{display:flex;gap:12px}
.coords-row input{flex:1;background:#ffffff;border:2px solid #e5e7eb;border-radius:8px;padding:12px;color:#1f2937;font-size:14px;font-family:'Inter',sans-serif}
.coords-row input:focus{outline:none;border-color:#f59e0b;box-shadow:0 0 0 3px rgba(245,158,11,0.1)}

/* Game Mode */
.mode-grid{display:flex;flex-direction:column;gap:12px}
.mode{display:flex;align-items:center;gap:16px;background:#f8fafc;border:2px solid #e2e8f0;border-radius:12px;padding:16px;cursor:pointer;transition:all 0.2s}
.mode:hover{border-color:#cbd5e1;background:#f1f5f9;transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.08)}
.mode.sel{border-color:#667eea;background:#f0f4ff;box-shadow:0 4px 12px rgba(102,126,234,0.2)}
.mode-icon{font-size:28px;width:44px;text-align:center}
.mode-name{color:#1e293b;font-family:'Poppins',sans-serif;font-size:14px;font-weight:600}
.mode-desc{color:#64748b;font-size:12px;margin-top:4px}
.mode-check{width:20px;height:20px;border:2px solid #cbd5e1;border-radius:50%;margin-left:auto;display:flex;align-items:center;justify-content:center;font-size:12px;color:transparent;transition:all 0.2s}
.mode.sel .mode-check{border-color:#667eea;background:#667eea;color:#ffffff}

/* Controls Tab */
.ctrl-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px 20px}
.ctrl-section{grid-column:1/-1;font-family:'Poppins',sans-serif;font-size:11px;font-weight:600;color:#667eea;text-transform:uppercase;letter-spacing:0.5px;margin-top:12px;padding-bottom:6px;border-bottom:2px solid #e8eef5}
.ctrl-section:first-child{margin-top:0}
.ctrl-row{display:flex;align-items:center;gap:10px;padding:6px 0}
.ctrl-key{background:#f0f4ff;border:2px solid #c7d2fe;border-radius:6px;padding:4px 10px;font-family:'Inter',sans-serif;font-size:11px;font-weight:600;color:#667eea}
.ctrl-action{font-size:12px;color:#475569}

/* Start Button */
.start-section{padding:20px 24px;border-top:2px solid #e8eef5;flex-shrink:0;background:rgba(248,250,252,0.8);backdrop-filter:blur(10px)}
.startBtn{width:100%;background:linear-gradient(135deg,#0f3460 0%,#533483 100%);border:2px solid rgba(255,255,255,0.2);border-radius:12px;padding:18px;font-family:'Orbitron',sans-serif;font-size:16px;font-weight:700;color:#ffffff;cursor:pointer;letter-spacing:2px;transition:all 0.3s;text-transform:uppercase;box-shadow:0 4px 20px rgba(83,52,131,0.4)}
.startBtn:hover{transform:translateY(-3px);box-shadow:0 12px 40px rgba(83,52,131,0.6),0 0 30px rgba(15,52,96,0.5);border-color:rgba(255,255,255,0.4)}

/* HUD */
#hud{position:fixed;top:20px;left:20px;z-index:100;display:none}
#hud.show{display:block}
.hud-box{background:rgba(255,255,255,0.95);border:none;border-radius:16px;padding:20px;min-width:160px;box-shadow:0 8px 24px rgba(0,0,0,0.1)}
#speed{font-family:'Poppins',sans-serif;font-size:42px;font-weight:700;color:#1e293b}
#speed.fast{color:#dc2626}
.hud-label{font-size:11px;color:#64748b;font-weight:500;text-transform:uppercase;letter-spacing:0.5px}
#street{font-family:'Inter',sans-serif;font-size:11px;color:#475569;margin-top:12px;border-top:2px solid #f1f5f9;padding-top:12px}
#boostBar{width:100%;height:6px;background:#f1f5f9;border-radius:3px;margin-top:10px;overflow:hidden}
#boostFill{height:100%;width:100%;background:linear-gradient(90deg,#667eea,#764ba2);transition:width 0.1s;border-radius:3px}
#boostFill.active{background:linear-gradient(90deg,#f59e0b,#d97706)}
.indicators{display:flex;gap:10px;margin-top:10px;font-size:10px}
.ind{color:#cbd5e1;font-weight:500}
.ind.on{color:#667eea}
.ind.warn{color:#dc2626}
#offRoadWarn{position:fixed;inset:0;pointer-events:none;border:4px solid transparent;z-index:50;transition:border-color 0.2s}
#offRoadWarn.active{border-color:rgba(239,68,68,0.6);animation:pulse 0.5s infinite}
@keyframes pulse{0%,100%{border-color:rgba(239,68,68,0.6)}50%{border-color:rgba(239,68,68,0.2)}}
#minimap{position:fixed;bottom:20px;left:20px;width:160px;height:160px;background:rgba(255,255,255,0.95);border:none;border-radius:16px;z-index:100;display:none;cursor:pointer;box-shadow:0 8px 24px rgba(0,0,0,0.1)}
#minimap.show{display:block}
#minimap:hover{box-shadow:0 12px 32px rgba(0,0,0,0.15)}
#largeMap{position:fixed;inset:0;background:rgba(0,0,0,0.8);z-index:150;display:none;align-items:center;justify-content:center;backdrop-filter:blur(4px)}
#largeMap.show{display:flex}
#largeMapCanvas{border:none;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,0.3)}
#mapClose{position:absolute;top:30px;right:30px;background:#ffffff;border:none;color:#1e293b;font-family:'Inter',sans-serif;font-size:14px;font-weight:600;padding:12px 24px;cursor:pointer;border-radius:10px;transition:all 0.2s;z-index:200}
#mapClose:hover{background:#f1f5f9;transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.1)}
#mapSatelliteToggle.active,#mapRoadsToggle.active{background:#0fc !important;color:#000 !important}
#modeHud{position:fixed;top:20px;left:50%;transform:translateX(-50%);background:rgba(255,255,255,0.95);border:none;border-radius:10px;padding:8px 16px;z-index:100;text-align:center;display:none;box-shadow:0 4px 12px rgba(0,0,0,0.1)}
#modeHud.show{display:block}
#modeTitle{font-family:'Poppins',sans-serif;font-size:11px;font-weight:600;color:#667eea;text-transform:uppercase;letter-spacing:0.5px}
#modeTimer{font-family:'Poppins',sans-serif;font-size:16px;font-weight:700;color:#1e293b;margin-top:2px;display:none}
#modeTimer.show{display:block}
#modeInfo{font-size:10px;color:#64748b;margin-top:2px;display:none}
#modeInfo.show{display:block}
#police{position:fixed;top:20px;right:20px;background:rgba(255,255,255,0.95);border:none;border-radius:12px;padding:10px 16px;color:#dc2626;font-family:'Poppins',sans-serif;font-size:13px;font-weight:600;z-index:100;display:none;box-shadow:0 8px 24px rgba(0,0,0,0.1)}
#police.show{display:block}
/* Float Menus - Three separate menus in triangle formation */
.floatMenuContainer{position:fixed;bottom:20px;right:20px;z-index:100;display:none;flex-direction:column;align-items:center;gap:12px}
.floatMenuContainer.show{display:flex}
.floatMenu{display:flex;flex-direction:column;align-items:center;position:relative}
.floatMenuRow{display:flex;gap:12px;justify-content:center}
.floatBtn{width:auto;min-width:120px;height:50px;padding:0 16px;border-radius:25px;background:#ffffff;border:none;font-size:14px;cursor:pointer;box-shadow:0 8px 24px rgba(0,0,0,0.15);transition:all 0.2s;position:relative;z-index:101;-webkit-tap-highlight-color:transparent;display:flex;align-items:center;justify-content:center;gap:8px;font-weight:600}
.floatBtn:active{transform:scale(0.95)}
.floatBtn:hover{transform:scale(1.05);box-shadow:0 12px 32px rgba(0,0,0,0.2)}
.floatBtn.travel{color:#10b981}
.floatBtn.realEstate{color:#3b82f6}
.floatBtn.explore{color:#f59e0b}
.floatBtn.game{color:#a855f7}
.btnIcon{font-size:20px;line-height:1}
.btnText{font-size:14px;font-weight:600;white-space:nowrap}
.floatItems{position:fixed;bottom:140px;right:20px;display:none;flex-direction:column;gap:6px;max-height:60vh;overflow-y:auto;min-width:160px;max-width:200px;z-index:102}
.floatMenu.open .floatItems{display:flex}
.floatItem{background:#ffffff;border:none;border-radius:10px;padding:10px 16px;color:#475569;font-size:12px;font-weight:500;cursor:pointer;white-space:nowrap;box-shadow:0 4px 12px rgba(0,0,0,0.1);transition:all 0.2s;overflow:hidden;text-overflow:ellipsis;max-width:100%}
.floatItem:hover{background:#f8fafc;transform:translateX(-4px);box-shadow:0 6px 16px rgba(0,0,0,0.15)}
.floatItem.on{background:#667eea;color:#ffffff}
.floatItem.recording{background:#dc2626;color:#ffffff}

/* Main Menu Button */
.mainMenuBtn{position:fixed;top:20px;right:20px;z-index:150;background:rgba(255,255,255,0.95);backdrop-filter:blur(10px);border:2px solid rgba(102,126,234,0.3);border-radius:12px;padding:12px 24px;color:#667eea;font-family:'Poppins',sans-serif;font-size:14px;font-weight:600;cursor:pointer;box-shadow:0 4px 16px rgba(0,0,0,0.1);transition:all 0.2s;display:none}
.mainMenuBtn.show{display:block}
.mainMenuBtn:hover{background:rgba(255,255,255,1);transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,0.15);border-color:#667eea}

/* Responsive adjustments for float menus */
@media (max-width: 768px) {
  .floatMenuContainer{bottom:10px;right:10px}
  .floatBtn{min-width:100px;height:45px;padding:0 12px;font-size:13px}
  .btnIcon{font-size:18px}
  .btnText{font-size:13px}
  .floatItems{min-width:140px;max-width:160px;font-size:11px}
  .floatItem{padding:8px 12px}

  /* Title screen mobile adjustments */
  .sub{font-size:15px;letter-spacing:2px}
  .menu-container{width:min(96vw,740px);max-height:calc(100dvh - 145px)}
  .loc-grid{grid-template-columns:1fr;gap:10px}
  .launch-switch-row{grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}
  .tab-btn{font-size:12px;padding:12px 8px}

  /* HUD elements */
  #hud{top:10px;left:10px;font-size:11px}
  #minimap{width:120px;height:120px}
  #modeHud{top:10px;font-size:10px;padding:6px 12px}
  #coords{bottom:180px;left:10px;font-size:10px;padding:8px 12px}
  #controlsTab{left:140px;max-width:180px;font-size:11px}
  #memoryFlowerFloatBtn{left:140px;bottom:72px}
  #buildModeIndicator{left:10px;bottom:66px;font-size:10px;padding:8px 10px;max-width:220px}

  /* Property panel */
  #propertyPanel{width:90vw;right:5vw;top:10px;max-height:70vh}

  /* Map controls */
  #largeMapCanvas{width:95vw;height:95vw;max-width:600px;max-height:600px}

  /* Modal adjustments */
  .modal-content{width:95vw;max-height:90vh}
  .modal-title{font-size:18px}
}

@media (max-width: 480px) {
  .floatMenuContainer{bottom:5px;right:5px}
  .floatBtn{min-width:90px;height:40px;padding:0 10px;font-size:12px}
  .btnIcon{font-size:16px}
  .btnText{font-size:12px}
  .floatItems{min-width:120px;max-width:140px;bottom:50px}
  .floatItem{padding:6px 10px;font-size:10px}
  .floatMenuRow{gap:6px}

  /* Title screen for small phones */
  .logo{font-size:clamp(28px, 10vw, 48px);letter-spacing:2px}
  .sub{font-size:13px;letter-spacing:2px;margin:0}
  .menu-container{width:99vw;max-height:calc(100dvh - 126px)}
  .launch-switch-row{grid-template-columns:1fr}
  .tab-btn{font-size:11px;padding:10px 6px}
  .tab-content{padding:16px}
  .custom-title{font-size:13px}
  .custom-row label{font-size:11px}
  .search-row input, .coords-row input{font-size:13px;padding:10px}
  .search-btn{padding:10px 14px}
  .startBtn{font-size:14px;padding:14px;letter-spacing:1px}

  /* HUD elements for phones */
  #hud{top:5px;left:5px;font-size:10px}
  #minimap{width:100px;height:100px}
  #modeHud{top:5px;font-size:9px;padding:5px 10px}
  #modeTimer{font-size:14px}
  #coords{bottom:160px;left:5px;font-size:9px;padding:6px 10px}
  #controlsTab{left:115px;max-width:150px;font-size:10px;bottom:15px}
  #memoryFlowerFloatBtn{left:115px;bottom:66px}
  #buildModeIndicator{left:5px;bottom:60px;font-size:9px;padding:7px 9px;max-width:190px}

  /* Property panel for phones */
  #propertyPanel{width:95vw;right:2.5vw;top:5px;max-height:75vh}
  .panel-title{font-size:16px}
  .property-card{padding:10px;margin-bottom:10px}
  .prop-price{font-size:18px}

  /* Map for phones */
  #largeMapCanvas{width:98vw;height:98vw;max-width:400px;max-height:400px}
  #mapClose{top:15px;right:15px;font-size:12px;padding:10px 18px}
  #mapZoomIn, #mapZoomOut, #mapSatelliteToggle, #mapRoadsToggle{width:40px;font-size:16px;padding:8px}
  #zoomLevel{font-size:10px;padding:4px 8px}

  /* Modal for phones */
  .modal-content{width:98vw}
  .modal-title{font-size:16px}
  .modal-close{width:32px;height:32px;font-size:24px}

  /* Pause/result screens */
  .pauseTitle{font-size:32px}
  .pauseBtn{min-width:140px;padding:12px 30px;font-size:13px}
  .resultBox, .caughtBox{padding:30px 40px}
  #resultTitle, .caughtTitle{font-size:24px}
}

/* Landscape orientation adjustments */
@media (max-height: 500px) and (orientation: landscape) {
  .menu-container{max-height:calc(100dvh - 88px);width:min(95vw,980px)}
  .tab-content{max-height:60vh}
  #propertyPanel{max-height:85vh}
  .logo{font-size:clamp(24px, 6vw, 48px);margin:0}
  .sub{font-size:11px;letter-spacing:2px;margin:0}
}

#controlsTab{position:fixed;bottom:20px;left:200px;background:rgba(255,255,255,0.95);border:none;border-radius:12px;z-index:100;display:none;font-size:12px;color:#475569;max-width:220px;box-shadow:0 8px 24px rgba(0,0,0,0.1)}
#controlsTab.show{display:block}
#ctrlHeader{padding:12px 16px;cursor:pointer;color:#667eea;font-family:'Poppins',sans-serif;font-weight:600}
#ctrlContent{padding:12px 16px;border-top:2px solid #f1f5f9;line-height:1.8}
#ctrlContent.hidden{display:none}
#memoryFlowerFloatBtn{position:fixed;bottom:78px;left:200px;width:46px;height:46px;background:linear-gradient(135deg,#ec4899,#db2777);border:none;border-radius:50%;color:#ffffff;font-size:23px;cursor:pointer;box-shadow:0 10px 26px rgba(236,72,153,0.38);z-index:101;display:none;transition:all 0.2s}
#memoryFlowerFloatBtn.show{display:flex;align-items:center;justify-content:center}
#memoryFlowerFloatBtn:hover{transform:scale(1.08);box-shadow:0 14px 34px rgba(236,72,153,0.45)}
#buildModeIndicator{position:fixed;left:20px;bottom:78px;background:rgba(17,24,39,0.88);border:1px solid rgba(251,146,60,0.7);border-radius:10px;padding:9px 12px;font-size:11px;color:#fdba74;z-index:101;display:none;max-width:280px;line-height:1.45;box-shadow:0 8px 20px rgba(0,0,0,0.25)}
#buildModeIndicator.show{display:block}
#coords{position:fixed;bottom:200px;left:20px;background:rgba(255,255,255,0.95);border:none;border-radius:10px;padding:10px 14px;font-size:11px;color:#475569;z-index:100;display:none;box-shadow:0 4px 12px rgba(0,0,0,0.1)}
#coords.show{display:block}
#loading{position:fixed;inset:0;background:#000 url('loading-bg.jpg') center center/cover no-repeat;display:none;align-items:center;justify-content:center;flex-direction:column;z-index:300;cursor:pointer}
#loading.show{display:flex}
.spinner{width:48px;height:48px;border:4px solid rgba(255,255,255,0.3);border-top-color:#ffffff;border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
#loadText{color:#ffffff;font-family:'Poppins',sans-serif;margin-top:20px;font-size:15px;font-weight:500}
#pauseScreen{position:fixed;inset:0;background:rgba(0,0,0,0.8);display:none;align-items:center;justify-content:center;flex-direction:column;z-index:250;backdrop-filter:blur(8px)}
#pauseScreen.show{display:flex}
.pauseTitle{font-family:'Poppins',sans-serif;font-size:42px;font-weight:700;color:#ffffff;margin-bottom:32px}
.pauseBtn{background:#ffffff;border:none;border-radius:12px;padding:14px 40px;color:#1e293b;font-family:'Poppins',sans-serif;font-size:14px;font-weight:600;cursor:pointer;margin:8px;min-width:180px;transition:all 0.2s}
.pauseBtn:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(255,255,255,0.2)}
#resultScreen{position:fixed;inset:0;background:rgba(0,0,0,0.8);display:none;align-items:center;justify-content:center;z-index:260;backdrop-filter:blur(8px)}
#resultScreen.show{display:flex}
.resultBox{background:#ffffff;border:none;border-radius:20px;padding:40px 60px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.3)}
#resultTitle{font-family:'Poppins',sans-serif;font-size:32px;font-weight:700;color:#667eea;margin-bottom:16px}
#resultStats{color:#475569;margin-bottom:24px;line-height:1.8;font-size:15px}
#caughtScreen{position:fixed;inset:0;background:rgba(220,38,38,0.15);display:none;align-items:center;justify-content:center;z-index:270;backdrop-filter:blur(8px)}
#caughtScreen.show{display:flex}
.caughtBox{background:#ffffff;border:none;border-radius:20px;padding:40px;text-align:center;box-shadow:0 20px 60px rgba(220,38,38,0.3)}
.caughtTitle{font-family:'Poppins',sans-serif;font-size:36px;font-weight:700;color:#dc2626;margin-bottom:16px}
.caughtText{color:#475569;margin-bottom:24px;font-size:15px}
.caughtBtn{background:#dc2626;border:none;border-radius:12px;padding:14px 32px;color:#ffffff;font-family:'Poppins',sans-serif;font-weight:600;cursor:pointer;transition:all 0.2s}
.caughtBtn:hover{background:#b91c1c;transform:translateY(-2px);box-shadow:0 8px 24px rgba(220,38,38,0.3)}

/* Real Estate System Styles */
#propertyPanel{position:fixed;top:20px;right:20px;width:380px;max-height:80vh;background:rgba(255,255,255,0.98);border:none;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,0.2);z-index:110;display:none;overflow:hidden;backdrop-filter:blur(10px)}
#propertyPanel.show{display:flex;flex-direction:column}
.panel-header{background:linear-gradient(135deg,#667eea,#764ba2);padding:20px;display:flex;justify-content:space-between;align-items:center;flex-shrink:0}
.panel-title{font-family:'Poppins',sans-serif;font-size:18px;font-weight:700;color:#ffffff;letter-spacing:0.5px}
.panel-close{background:rgba(255,255,255,0.2);border:none;color:#ffffff;font-size:24px;width:32px;height:32px;border-radius:50%;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center}
.panel-close:hover{background:rgba(255,255,255,0.3);transform:scale(1.1)}
.panel-content{padding:16px;overflow-y:auto;flex:1}
.property-card{background:#f8fafc;border:2px solid #e2e8f0;border-radius:12px;padding:12px;margin-bottom:12px;cursor:pointer;transition:all 0.2s}
.property-card:hover{border-color:#667eea;transform:translateY(-2px);box-shadow:0 4px 12px rgba(102,126,234,0.2)}
.prop-photo{width:100%;height:180px;background:#e2e8f0;border-radius:8px;overflow:hidden;margin-bottom:10px;display:flex;align-items:center;justify-content:center}
.prop-photo img{width:100%;height:100%;object-fit:cover}
.prop-photo-placeholder{font-size:48px;color:#cbd5e1}
.prop-price{font-family:'Poppins',sans-serif;font-size:20px;font-weight:700;color:#667eea;margin-bottom:4px}
.prop-address{font-size:13px;color:#1e293b;font-weight:500;margin-bottom:6px}
.prop-details{font-size:12px;color:#64748b;display:flex;gap:12px}
#propertyModal{position:fixed;inset:0;background:rgba(0,0,0,0.85);display:none;align-items:center;justify-content:center;z-index:200;backdrop-filter:blur(8px)}
#propertyModal.show{display:flex}
.modal-content{background:#ffffff;border-radius:20px;width:90%;max-width:700px;max-height:85vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 20px 60px rgba(0,0,0,0.3)}
.modal-header{background:linear-gradient(135deg,#667eea,#764ba2);padding:24px;display:flex;justify-content:space-between;align-items:center;flex-shrink:0}
.modal-title{font-family:'Poppins',sans-serif;font-size:20px;font-weight:700;color:#ffffff;flex:1;padding-right:20px}
.modal-close{background:rgba(255,255,255,0.2);border:none;color:#ffffff;font-size:28px;width:40px;height:40px;border-radius:50%;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;line-height:1}
.modal-close:hover{background:rgba(255,255,255,0.3);transform:scale(1.1)}
.modal-body{padding:24px;overflow-y:auto;flex:1}
.modal-body img{width:100%;border-radius:12px;margin-bottom:16px}
.modal-body p{color:#475569;line-height:1.6;margin-bottom:12px}
.modal-body button{background:#667eea;border:none;border-radius:8px;padding:12px 24px;color:#ffffff;font-family:'Poppins',sans-serif;font-weight:600;cursor:pointer;transition:all 0.2s;margin-top:12px}
.modal-body button:hover{background:#5568d3;transform:translateY(-2px);box-shadow:0 4px 12px rgba(102,126,234,0.3)}
.prop-stat{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #e2e8f0}
.prop-stat-label{color:#64748b;font-size:13px}
.prop-stat-value{color:#1e293b;font-weight:600;font-size:13px}
#realEstateBtn{position:fixed;bottom:90px;right:20px;width:56px;height:56px;background:linear-gradient(135deg,#10b981,#059669);border:none;border-radius:50%;color:#ffffff;font-size:24px;cursor:pointer;box-shadow:0 8px 24px rgba(16,185,129,0.4);transition:all 0.2s;z-index:100;display:none}
#realEstateBtn.show{display:block}
#realEstateBtn:hover{transform:scale(1.1);box-shadow:0 12px 32px rgba(16,185,129,0.5)}
#historicBtn.show{display:block}
#historicBtn:hover{transform:scale(1.1);box-shadow:0 12px 32px rgba(245,158,11,0.5)}
#historicPanel.show{display:flex}

/* Persistent memory markers */
#memoryComposer{position:fixed;right:20px;bottom:20px;width:min(360px,calc(100vw - 28px));background:rgba(255,255,255,0.98);border:none;border-radius:14px;box-shadow:0 16px 40px rgba(0,0,0,0.28);padding:14px;z-index:140;display:none;backdrop-filter:blur(8px)}
#memoryComposer.show{display:block}
.memoryComposerTitle{font-family:'Poppins',sans-serif;font-size:15px;font-weight:700;color:#1f2937}
.memoryComposerSub{font-size:11px;color:#64748b;margin-top:2px;margin-bottom:10px}
.memoryComposerSub.warn{color:#b91c1c;font-weight:600}
.memoryTypeRow{display:flex;gap:8px;margin-bottom:10px}
.memoryTypeBtn{flex:1;background:#f1f5f9;border:2px solid #dbe4ef;border-radius:10px;padding:8px 10px;font-family:'Poppins',sans-serif;font-size:12px;font-weight:600;color:#475569;cursor:pointer;transition:all 0.2s}
.memoryTypeBtn:hover{border-color:#cbd5e1;background:#e9eff7}
.memoryTypeBtn.active{border-color:#6366f1;background:#e0e7ff;color:#3730a3}
#memoryMessageInput{width:100%;min-height:90px;max-height:180px;resize:vertical;border:2px solid #e2e8f0;border-radius:10px;padding:10px 12px;font-family:'Inter',sans-serif;font-size:13px;line-height:1.4;color:#334155}
#memoryMessageInput:focus{outline:none;border-color:#818cf8;box-shadow:0 0 0 3px rgba(129,140,248,0.2)}
.memoryComposerMeta{display:flex;justify-content:space-between;align-items:center;margin-top:8px}
#memoryComposerStatus{font-size:11px;color:#64748b}
#memoryComposerStatus.error{color:#b91c1c}
#memoryCharCount{font-size:11px;color:#64748b;font-weight:600}
.memoryActionRow{display:flex;gap:8px;margin-top:10px}
.memoryActionBtn{flex:1;border:none;border-radius:10px;padding:10px 12px;font-family:'Poppins',sans-serif;font-size:12px;font-weight:600;cursor:pointer;transition:all 0.2s}
#memoryCancelBtn{background:#e2e8f0;color:#334155}
#memoryCancelBtn:hover{background:#cbd5e1}
#memoryPlaceBtn{background:#4f46e5;color:#ffffff}
#memoryPlaceBtn:hover{background:#4338ca}
#memoryDeleteAllBtn{background:#b91c1c;color:#ffffff}
#memoryDeleteAllBtn:hover{background:#991b1b}

#memoryInfoPanel{position:fixed;top:95px;right:20px;width:min(340px,calc(100vw - 28px));background:rgba(17,24,39,0.94);color:#e2e8f0;border:1px solid rgba(99,102,241,0.4);border-radius:12px;box-shadow:0 16px 38px rgba(0,0,0,0.35);padding:12px;display:none;z-index:135}
#memoryInfoPanel.show{display:block}
#memoryInfoTitle{font-family:'Poppins',sans-serif;font-size:14px;font-weight:700;color:#c7d2fe;margin-bottom:6px}
#memoryInfoText{font-size:13px;line-height:1.5;color:#f8fafc;white-space:pre-wrap;word-break:break-word}
#memoryInfoMeta{font-size:11px;color:#93c5fd;margin-top:8px}
.memoryInfoActions{display:flex;gap:8px;margin-top:10px}
.memoryInfoBtn{flex:1;border:none;border-radius:8px;padding:8px 10px;font-family:'Poppins',sans-serif;font-size:11px;font-weight:600;cursor:pointer}
#memoryInfoCloseBtn{background:#1e293b;color:#e2e8f0}
#memoryDeleteBtn{background:#b91c1c;color:#ffffff}

@media (max-width: 768px){
  #memoryComposer{left:10px;right:10px;bottom:12px;width:auto}
  #memoryInfoPanel{left:10px;right:10px;top:72px;width:auto}
}
</style>
</head>
<body>
<div id="titleScreen">
<div class="logo">WORLD EXPLORER</div>
<div class="sub">Explore Any Place on Earth and Beyond</div>
<div class="menu-container">
<div class="tab-nav">
<button class="tab-btn active" data-tab="location">Location</button>
<button class="tab-btn" data-tab="settings">Settings</button>
<button class="tab-btn" data-tab="controls">Controls</button>
</div>
<div class="tab-content active" id="tab-location">
<div class="launch-switch-row">
<button class="launch-switch-btn active" id="earthLaunchToggle" data-launch="earth" type="button">üåç Earth</button>
<button class="launch-switch-btn" id="moonLaunchToggle" data-launch="moon" type="button">üåô Moon</button>
<button class="launch-switch-btn" id="spaceLaunchToggle" data-launch="space" type="button">üöÄ Space</button>
</div>
<div class="loc-grid custom-centered">
<div class="loc custom" data-loc="custom"><div class="loc-name">üåç Custom</div><div class="loc-region">Any Location</div></div>
</div>
<div id="customPanel">
<div class="custom-title">üåç Enter Any Location Worldwide</div>

<div class="custom-row">
<label>üîç Search by Location Name</label>
<div class="search-row">
<input type="text" id="locationSearch" placeholder="Try: Seattle, Tokyo, Paris France">
<button class="search-btn" id="locationSearchBtn">üîç</button>
</div>
<div id="locationSearchStatus" style="font-size:11px;margin-top:6px;min-height:16px;color:#6b7280">
Not case sensitive! Try: "Seattle" ‚Ä¢ "Tokyo" ‚Ä¢ "Paris, France" ‚Ä¢ "Austin, TX"
</div>
</div>

<div class="divider"><span>OR</span></div>

<div class="custom-row">
<label>üìç Enter Exact Coordinates</label>
<div class="coords-row">
<input type="number" id="customLat" placeholder="Latitude (e.g. 39.2904)" step="0.0001">
<input type="number" id="customLon" placeholder="Longitude (e.g. -76.6122)" step="0.0001">
</div>
<div style="font-size:11px;margin-top:6px;color:#6b7280">Right-click on Google Maps and copy coordinates</div>
</div>
</div>
<div class="loc-grid">
<div class="loc sel" data-loc="baltimore"><div class="loc-name">Baltimore</div><div class="loc-region">Maryland, USA</div></div>
<div class="loc" data-loc="hollywood"><div class="loc-name">Hollywood</div><div class="loc-region">California, USA</div></div>
<div class="loc" data-loc="newyork"><div class="loc-name">New York</div><div class="loc-region">New York, USA</div></div>
<div class="loc" data-loc="miami"><div class="loc-name">Miami</div><div class="loc-region">Florida, USA</div></div>
<div class="loc" data-loc="tokyo"><div class="loc-name">Tokyo</div><div class="loc-region">Japan</div></div>
<div class="loc" data-loc="monaco"><div class="loc-name">Monaco</div><div class="loc-region">Monte Carlo</div></div>
<div class="loc" data-loc="nurburgring"><div class="loc-name">N√ºrburgring</div><div class="loc-region">Germany</div></div>
<div class="loc" data-loc="lasvegas"><div class="loc-name">Las Vegas</div><div class="loc-region">Nevada, USA</div></div>
<div class="loc" data-loc="london"><div class="loc-name">London</div><div class="loc-region">United Kingdom</div></div>
<div class="loc" data-loc="paris"><div class="loc-name">Paris</div><div class="loc-region">France</div></div>
<div class="loc" data-loc="dubai"><div class="loc-name">Dubai</div><div class="loc-region">UAE</div></div>
<div class="loc" data-loc="sanfrancisco"><div class="loc-name">San Francisco</div><div class="loc-region">California, USA</div></div>
<div class="loc" data-loc="losangeles"><div class="loc-name">Los Angeles</div><div class="loc-region">California, USA</div></div>
<div class="loc" data-loc="chicago"><div class="loc-name">Chicago</div><div class="loc-region">Illinois, USA</div></div>
<div class="loc" data-loc="seattle"><div class="loc-name">Seattle</div><div class="loc-region">Washington, USA</div></div>
</div>
</div>
<div class="tab-content" id="tab-settings">
<div style="padding:8px 0">
<div style="margin-bottom:24px">
<div style="font-family:'Poppins',sans-serif;font-size:15px;font-weight:600;color:#667eea;margin-bottom:12px;display:flex;align-items:center;gap:8px">
üéÆ Game Mode
</div>
<div class="mode-grid">
<div class="mode sel" data-mode="free"><div class="mode-icon">üöó</div><div><div class="mode-name">Free Roam</div><div class="mode-desc">Explore the city at your own pace</div></div><div class="mode-check">‚úì</div></div>
<div class="mode" data-mode="trial"><div class="mode-icon">‚è±Ô∏è</div><div><div class="mode-name">Time Trial</div><div class="mode-desc">Race to the destination as fast as you can</div></div><div class="mode-check">‚úì</div></div>
<div class="mode" data-mode="checkpoint"><div class="mode-icon">üèÅ</div><div><div class="mode-name">Checkpoints</div><div class="mode-desc">Collect all markers scattered across the map</div></div><div class="mode-check">‚úì</div></div>
<div style="grid-column:1/-1;padding:12px 0;text-align:center;font-size:11px;color:#64748b;border-top:2px solid #e8eef5;margin-top:8px;">üí° Toggle walking mode anytime with <b>F</b> key or float menu</div>
</div>
</div>
<div style="margin-bottom:24px">
<div style="font-family:'Poppins',sans-serif;font-size:15px;font-weight:600;color:#667eea;margin-bottom:12px;display:flex;align-items:center;gap:8px">
‚ö° Performance Benchmark
</div>
<div style="background:#f8fafc;border:2px solid #e2e8f0;border-radius:12px;padding:14px">
<label style="display:block;font-size:12px;font-weight:600;color:#1e293b;margin-bottom:6px">Mode</label>
<select id="perfModeSelect" style="width:100%;background:#ffffff;border:2px solid #e2e8f0;border-radius:8px;padding:10px;font-size:13px;color:#1e293b;margin-bottom:12px">
<option value="rdt">RDT Optimized</option>
<option value="baseline">Baseline (No RDT Budgeting)</option>
</select>
<label style="display:flex;align-items:center;gap:10px;font-size:12px;color:#334155;margin-bottom:12px;cursor:pointer">
<input type="checkbox" id="perfOverlayToggle" style="width:16px;height:16px;cursor:pointer">
Show live benchmark overlay in-game
</label>
<div style="display:flex;gap:8px;margin-bottom:8px">
<button id="perfApplyReload" style="flex:1;background:#0ea5e9;border:none;border-radius:8px;padding:9px;color:#ffffff;font-family:'Poppins',sans-serif;font-weight:600;cursor:pointer;font-size:12px">Apply + Reload World</button>
<button id="perfCopySnapshot" style="flex:1;background:#475569;border:none;border-radius:8px;padding:9px;color:#ffffff;font-family:'Poppins',sans-serif;font-weight:600;cursor:pointer;font-size:12px">Copy Snapshot</button>
</div>
<div id="perfSettingsStatus" style="font-size:11px;color:#64748b;min-height:16px">
Use this to compare RDT and baseline with real runtime data.
</div>
</div>
</div>
<div style="margin-bottom:24px">
<div style="font-family:'Poppins',sans-serif;font-size:15px;font-weight:600;color:#667eea;margin-bottom:12px;display:flex;align-items:center;gap:8px">
üè† Real Estate Mode
</div>
<label style="display:flex;align-items:center;gap:12px;cursor:pointer;padding:12px;background:#f8fafc;border-radius:8px;border:2px solid #e2e8f0;transition:all 0.2s" id="realEstateToggleLabel">
<input type="checkbox" id="realEstateToggle" style="width:20px;height:20px;cursor:pointer">
<div>
<div style="font-size:13px;font-weight:600;color:#1e293b">Enable Real Estate Features</div>
<div style="font-size:11px;color:#64748b;margin-top:2px">Show property listings and prices in 3D</div>
</div>
</label>
</div>
<div style="margin-bottom:24px">
<div style="font-family:'Poppins',sans-serif;font-size:15px;font-weight:600;color:#667eea;margin-bottom:12px;display:flex;align-items:center;gap:8px">
üîë API Configuration
</div>
<div style="background:#f8fafc;border:2px solid #e2e8f0;border-radius:12px;padding:16px">
<div style="margin-bottom:16px">
<label style="display:block;font-size:12px;font-weight:600;color:#1e293b;margin-bottom:6px">Estated API Key (FREE - 1000/month) ‚≠ê</label>
<input type="text" id="estatedKeyInput" placeholder="Enter your Estated API key" style="width:100%;background:#ffffff;border:2px solid #e2e8f0;border-radius:8px;padding:10px;font-size:13px;font-family:'Inter',sans-serif;color:#1e293b;margin-bottom:4px">
<div style="font-size:10px;color:#10b981;margin-bottom:8px">
‚úì Recommended: Highest free tier! Get key at <a href="https://estated.com" target="_blank" style="color:#10b981;font-weight:600">Estated.com</a>
</div>
</div>
<div style="margin-bottom:16px">
<label style="display:block;font-size:12px;font-weight:600;color:#1e293b;margin-bottom:6px">ATTOM API Key</label>
<input type="text" id="attomKeyInput" placeholder="Enter your ATTOM API key" style="width:100%;background:#ffffff;border:2px solid #e2e8f0;border-radius:8px;padding:10px;font-size:13px;font-family:'Inter',sans-serif;color:#1e293b;margin-bottom:4px">
<div style="font-size:10px;color:#64748b;margin-bottom:8px">
‚ÑπÔ∏è Premium data with free trial. Get key at <a href="https://www.attomdata.com" target="_blank" style="color:#667eea">ATTOM.com</a>
</div>
</div>
<div style="margin-bottom:12px">
<label style="display:block;font-size:12px;font-weight:600;color:#1e293b;margin-bottom:6px">RentCast API Key (Optional)</label>
<input type="text" id="rentcastKeyInput" placeholder="Enter your RentCast API key" style="width:100%;background:#ffffff;border:2px solid #e2e8f0;border-radius:8px;padding:10px;font-size:13px;font-family:'Inter',sans-serif;color:#1e293b;margin-bottom:4px">
<div style="font-size:10px;color:#64748b;margin-bottom:8px">
‚ÑπÔ∏è 100 free requests/month. Get key at <a href="https://rentcast.io" target="_blank" style="color:#667eea">RentCast.io</a>
</div>
</div>
<button id="saveApiKey" style="background:#667eea;border:none;border-radius:8px;padding:10px 20px;color:#ffffff;font-family:'Poppins',sans-serif;font-weight:600;cursor:pointer;font-size:13px;transition:all 0.2s;width:100%">
üíæ Save All API Keys
</button>
</div>
</div>
<div>
<div style="font-family:'Poppins',sans-serif;font-size:15px;font-weight:600;color:#667eea;margin-bottom:12px;display:flex;align-items:center;gap:8px">
‚ÑπÔ∏è About Real Estate APIs
</div>
<div style="background:#f0f4ff;border:2px solid #c7d2fe;border-radius:12px;padding:16px;font-size:12px;color:#475569;line-height:1.6">
<p style="margin:0 0 8px 0"><strong>üåü Estated (Recommended):</strong> 1000 free requests/month - highest free tier!</p>
<p style="margin:0 0 8px 0"><strong>üíé ATTOM:</strong> Premium comprehensive data with free trial available.</p>
<p style="margin:0 0 8px 0"><strong>üè† RentCast:</strong> 100 free requests/month for listings with photos.</p>
<p style="margin:0"><strong>Demo Mode:</strong> No API key needed - realistic simulated data for testing.</p>
</div>
</div>
</div>
</div>
<div class="tab-content" id="tab-controls">
<div class="ctrl-grid">
<div class="ctrl-section">Driving</div>
<div class="ctrl-row"><span class="ctrl-key">W</span><span class="ctrl-key">‚Üë</span><span class="ctrl-action">Accelerate</span></div>
<div class="ctrl-row"><span class="ctrl-key">S</span><span class="ctrl-key">‚Üì</span><span class="ctrl-action">Brake/Reverse</span></div>
<div class="ctrl-row"><span class="ctrl-key">A</span><span class="ctrl-key">‚Üê</span><span class="ctrl-action">Turn Left</span></div>
<div class="ctrl-row"><span class="ctrl-key">D</span><span class="ctrl-key">‚Üí</span><span class="ctrl-action">Turn Right</span></div>
<div class="ctrl-row"><span class="ctrl-key">Space</span><span class="ctrl-action">Handbrake</span></div>
<div class="ctrl-row"><span class="ctrl-key">Ctrl</span><span class="ctrl-action">Boost</span></div>
<div class="ctrl-row"><span class="ctrl-key">Shift</span><span class="ctrl-action">Off-Road Mode</span></div>
<div class="ctrl-section">Walking Mode</div>
<div class="ctrl-row"><span class="ctrl-key">‚Üë/‚Üì</span><span class="ctrl-action">Walk Forward/Back</span></div>
<div class="ctrl-row"><span class="ctrl-key">‚Üê/‚Üí</span><span class="ctrl-action">Strafe Left/Right</span></div>
<div class="ctrl-row"><span class="ctrl-key">A/D</span><span class="ctrl-action">Look Left/Right</span></div>
<div class="ctrl-row"><span class="ctrl-key">W/S</span><span class="ctrl-action">Look Up/Down</span></div>
<div class="ctrl-row"><span class="ctrl-key">Space</span><span class="ctrl-action">Jump</span></div>
<div class="ctrl-row"><span class="ctrl-key">Shift</span><span class="ctrl-action">Run (2x speed)</span></div>
<div class="ctrl-row"><span class="ctrl-key">Right Click + Drag</span><span class="ctrl-action">Mouse Look</span></div>
<div class="ctrl-section">Drone Controls</div>
<div class="ctrl-row"><span class="ctrl-key">W/S</span><span class="ctrl-action">Move Forward/Back</span></div>
<div class="ctrl-row"><span class="ctrl-key">A/D</span><span class="ctrl-action">Move Left/Right</span></div>
<div class="ctrl-row"><span class="ctrl-key">Space</span><span class="ctrl-action">Move Up</span></div>
<div class="ctrl-row"><span class="ctrl-key">Shift/Ctrl</span><span class="ctrl-action">Move Down</span></div>
<div class="ctrl-row"><span class="ctrl-key">‚Üë/‚Üì</span><span class="ctrl-action">Look Up/Down</span></div>
<div class="ctrl-row"><span class="ctrl-key">‚Üê/‚Üí</span><span class="ctrl-action">Turn Left/Right</span></div>
<div class="ctrl-row"><span class="ctrl-key">Mouse</span><span class="ctrl-action">Look Around</span></div>
<div class="ctrl-section">Camera & View</div>
<div class="ctrl-row"><span class="ctrl-key">C</span><span class="ctrl-action">Cycle Camera (3rd/1st/Overhead)</span></div>
<div class="ctrl-row"><span class="ctrl-key">V</span><span class="ctrl-action">Look Back</span></div>
<div class="ctrl-section">Mode Switching</div>
<div class="ctrl-row"><span class="ctrl-key">F</span><span class="ctrl-action">Toggle Walk/Drive Mode</span></div>
<div class="ctrl-row"><span class="ctrl-key">6</span><span class="ctrl-action">Toggle Drone Mode</span></div>
<div class="ctrl-section">Navigation & Map</div>
<div class="ctrl-row"><span class="ctrl-key">M</span><span class="ctrl-action">Toggle Map</span></div>
<div class="ctrl-row"><span class="ctrl-key">Right Click on Map</span><span class="ctrl-action">Teleport to Location</span></div>
<div class="ctrl-row"><span class="ctrl-key">Left Click on Map</span><span class="ctrl-action">View Property/POI Info</span></div>
<div class="ctrl-row"><span class="ctrl-key">N</span><span class="ctrl-action">Next City (Teleport)</span></div>
<div class="ctrl-section">Space Exploration</div>
<div class="ctrl-row"><span class="ctrl-key">Click on Moon</span><span class="ctrl-action">Travel to Moon</span></div>
<div class="ctrl-row"><span class="ctrl-key">Click on Stars</span><span class="ctrl-action">View Constellation Info</span></div>
<div class="ctrl-row"><span class="ctrl-key">Click Apollo 11 Flag</span><span class="ctrl-action">View Mission Info (on Moon)</span></div>
<div class="ctrl-section">Space Flight Controls</div>
<div class="ctrl-row"><span class="ctrl-key">‚Üê/‚Üí</span><span class="ctrl-action">Yaw Left/Right</span></div>
<div class="ctrl-row"><span class="ctrl-key">‚Üë/‚Üì</span><span class="ctrl-action">Pitch Up/Down</span></div>
<div class="ctrl-row"><span class="ctrl-key">Space</span><span class="ctrl-action">Thrust / Boost</span></div>
<div class="ctrl-row"><span class="ctrl-key">Shift</span><span class="ctrl-action">Brake / Decelerate</span></div>
<div class="ctrl-row"><span class="ctrl-key">LAND ON ... Button</span><span class="ctrl-action">Land when in range</span></div>
<div class="ctrl-row"><span class="ctrl-key">Click Planets/Asteroids/Galaxies</span><span class="ctrl-action">Inspect deep-space object info</span></div>
<div class="ctrl-section">Other</div>
<div class="ctrl-row"><span class="ctrl-key">Exploration Menu</span><span class="ctrl-action">Place/remove memory pin or flower</span></div>
<div class="ctrl-row"><span class="ctrl-key">R</span><span class="ctrl-action">Record/Stop Track</span></div>
<div class="ctrl-row"><span class="ctrl-key">Esc</span><span class="ctrl-action">Pause</span></div>
</div>
</div>
<div class="start-section"><button class="startBtn" id="startBtn">EXPLORE</button></div>
</div>
</div>
<div id="hud"><div class="hud-box">
<div id="speed">0</div>
<div class="hud-label">MPH <span style="margin-left:6px">LIMIT <span id="limit">--</span></span></div>
<div id="boostBar"><div id="boostFill"></div></div>
<div id="street">Loading...</div>
<div class="indicators"><span class="ind" id="indBrake">BRK</span><span class="ind" id="indBoost">BOOST</span><span class="ind" id="indDrift">DRIFT</span><span class="ind" id="indOff">OFF</span></div>
</div></div>
<div id="coords">--</div>
<div id="offRoadWarn"></div>
<canvas id="minimap" width="150" height="150"></canvas>
<div id="largeMap">
<canvas id="largeMapCanvas" width="800" height="800"></canvas>
<button id="mapClose">Close Map (M)</button>
<button id="mapLegend" style="position:absolute;bottom:20px;left:20px;background:rgba(0,0,0,0.8);border:2px solid #0fc;color:#0fc;font-family:Orbitron;font-size:12px;padding:10px 20px;cursor:pointer;border-radius:6px">üìã Legend</button>
<div id="legendPanel" style="position:absolute;top:20px;left:20px;background:rgba(0,0,0,0.95);border:2px solid #0fc;color:#0fc;font-family:Orbitron;border-radius:12px;padding:16px;max-width:340px;display:none;max-height:calc(100% - 40px);overflow-y:auto;z-index:200">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;border-bottom:1px solid #0fc;padding-bottom:8px">
    <div style="font-size:14px;font-weight:bold">MAP LEGEND & FILTERS</div>
    <button onclick="closeLegend()" style="background:transparent;border:none;color:#0fc;font-size:18px;cursor:pointer;padding:0;width:24px;height:24px">√ó</button>
  </div>

  <div style="margin-bottom:12px;padding:8px;background:rgba(0,255,200,0.1);border-radius:6px">
    <div style="font-size:10px;margin-bottom:6px;opacity:0.8">Toggle map features on/off:</div>
    <button onclick="toggleAllLayers(true)" style="background:#0fc;color:#000;border:none;padding:4px 8px;border-radius:4px;font-size:9px;cursor:pointer;margin-right:6px;font-family:Orbitron;font-weight:bold">Show All</button>
    <button onclick="toggleAllLayers(false)" style="background:#f36;color:#fff;border:none;padding:4px 8px;border-radius:4px;font-size:9px;cursor:pointer;font-family:Orbitron;font-weight:bold">Hide All</button>
  </div>

  <div style="margin-bottom:12px">
    <div style="font-size:11px;font-weight:bold;margin-bottom:6px;color:#0ff;display:flex;align-items:center;gap:6px">
      <input type="checkbox" id="filterProperties" checked onchange="updateMapLayers()" style="cursor:pointer">
      <label for="filterProperties" style="cursor:pointer">PROPERTIES</label>
    </div>
    <div style="font-size:10px;line-height:1.6;padding-left:24px;opacity:0.9">
      <div style="margin-bottom:3px"><span style="color:#10b981">‚óè Green</span> - For Sale</div>
      <div style="margin-bottom:3px"><span style="color:#3b82f6">‚óè Blue</span> - For Rent</div>
      <div style="margin-bottom:3px">Click marker for details & navigation</div>
    </div>
  </div>

  <div style="margin-bottom:12px">
    <div style="font-size:11px;font-weight:bold;margin-bottom:6px;color:#0ff;display:flex;align-items:center;gap:6px">
      <input type="checkbox" id="filterNavigation" checked onchange="updateMapLayers()" style="cursor:pointer">
      <label for="filterNavigation" style="cursor:pointer">NAVIGATION ROUTE</label>
    </div>
    <div style="font-size:10px;line-height:1.6;padding-left:24px;opacity:0.9">
      <div style="margin-bottom:3px"><span style="color:#00ff88">‚ãØ‚ãØ‚ãØ</span> Active Route Line</div>
      <div style="margin-bottom:3px"><span style="color:#00ff88">‚óâ</span> Destination Marker</div>
    </div>
  </div>

  <div style="margin-bottom:12px">
    <div style="font-size:11px;font-weight:bold;margin-bottom:8px;color:#0ff;display:flex;align-items:center;gap:6px">
      <input type="checkbox" id="filterPOIsAll" checked onchange="toggleAllPOIs()" style="cursor:pointer">
      <label for="filterPOIsAll" style="cursor:pointer">POINTS OF INTEREST</label>
    </div>
    <div style="font-size:10px;line-height:1.4;padding-left:24px;opacity:0.9">
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterSchools" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterSchools" style="cursor:pointer">üè´ Schools & Universities</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterHealthcare" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterHealthcare" style="cursor:pointer">üè• Healthcare</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterEmergency" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterEmergency" style="cursor:pointer">üëÆ Police & üöí Fire</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterFood" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterFood" style="cursor:pointer">üçΩÔ∏è Restaurants & Cafes</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterShopping" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterShopping" style="cursor:pointer">üè™ Shopping & Malls</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterCulture" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterCulture" style="cursor:pointer">üèõÔ∏è Museums & Attractions</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterHistoric" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterHistoric" style="cursor:pointer">üóø Historic Sites</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterParks" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterParks" style="cursor:pointer">üå≥ Parks & Recreation</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterParking" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterParking" style="cursor:pointer">üÖøÔ∏è Parking</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterFuel" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterFuel" style="cursor:pointer">‚õΩ Gas Stations</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterBanks" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterBanks" style="cursor:pointer">üè¶ Banks</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterPostal" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterPostal" style="cursor:pointer">üìÆ Post Offices</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterHotels" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterHotels" style="cursor:pointer">üè® Hotels</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterTourism" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterTourism" style="cursor:pointer">‚≠ê Tourism & Viewpoints</label>
      </div>
    </div>
  </div>

  <div style="margin-bottom:12px">
    <div style="font-size:11px;font-weight:bold;margin-bottom:8px;color:#0ff">MEMORY MARKERS</div>
    <div style="font-size:11px;line-height:1.5;padding-left:24px;opacity:0.95">
      <div style="margin-bottom:4px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterMemoryPins" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterMemoryPins" style="cursor:pointer;font-size:12px;font-weight:600;display:flex;align-items:center;gap:6px">
          <span style="color:#ef4444;font-size:16px;line-height:1">üìç</span>
          Pin memories
        </label>
      </div>
      <div style="margin-bottom:4px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterMemoryFlowers" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterMemoryFlowers" style="cursor:pointer;font-size:12px;font-weight:600;display:flex;align-items:center;gap:6px">
          <span style="color:#ec4899;font-size:16px;line-height:1">üå∏</span>
          Flower memories
        </label>
      </div>
      <div style="margin-bottom:3px;font-size:10px;opacity:0.85">Shown on minimap and large map</div>
    </div>
  </div>

  <div style="margin-bottom:12px">
    <div style="font-size:11px;font-weight:bold;margin-bottom:8px;color:#0ff;display:flex;align-items:center;gap:6px">
      <input type="checkbox" id="filterGameElementsAll" checked onchange="toggleAllGameElements()" style="cursor:pointer">
      <label for="filterGameElementsAll" style="cursor:pointer">GAME ELEMENTS</label>
    </div>
    <div style="font-size:10px;line-height:1.4;padding-left:24px;opacity:0.9">
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterCheckpoints" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterCheckpoints" style="cursor:pointer"><span style="color:#f36">‚óè</span> Checkpoints (game mode)</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterDestination" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterDestination" style="cursor:pointer"><span style="color:#fc0">‚óè</span> Trial Destination</label>
      </div>
      <div style="margin-bottom:3px;display:flex;align-items:center;gap:6px">
        <input type="checkbox" id="filterCustomTrack" checked onchange="updateMapLayers()" style="cursor:pointer">
        <label for="filterCustomTrack" style="cursor:pointer"><span style="color:#fa0">‚îÅ‚îÅ</span> Custom Track</label>
      </div>
    </div>
  </div>

  <div style="margin-bottom:12px">
    <div style="font-size:11px;font-weight:bold;margin-bottom:6px;color:#0ff;display:flex;align-items:center;gap:6px">
      <input type="checkbox" id="filterPolice" checked onchange="updateMapLayers()" style="cursor:pointer">
      <label for="filterPolice" style="cursor:pointer">POLICE CARS</label>
    </div>
    <div style="font-size:10px;line-height:1.6;padding-left:24px;opacity:0.9">
      <div style="margin-bottom:3px">üöì Police Vehicles</div>
      <div style="margin-bottom:3px"><span style="color:#f00">Red/Blue</span> when chasing</div>
    </div>
  </div>

  <div style="margin-bottom:12px">
    <div style="font-size:11px;font-weight:bold;margin-bottom:6px;color:#0ff;display:flex;align-items:center;gap:6px">
      <input type="checkbox" id="filterRoads" checked onchange="toggleRoads()" style="cursor:pointer">
      <label for="filterRoads" style="cursor:pointer">ROAD OVERLAY</label>
    </div>
    <div style="font-size:10px;line-height:1.6;padding-left:24px;opacity:0.9">
      <div style="margin-bottom:3px">üõ£Ô∏è Street Network</div>
      <div style="margin-bottom:3px">Shows road details on map</div>
    </div>
  </div>

  <div style="font-size:9px;opacity:0.6;margin-top:12px;padding-top:8px;border-top:1px solid #0fc">
    Data: OpenStreetMap contributors<br>
    Click any map element for details & directions<br>
    <span style="color:#0f8;font-weight:bold">Right-click map to teleport to location</span>
  </div>
</div>

<!-- Map Click Info Panel -->
<div id="mapInfoPanel" style="position:absolute;top:20px;right:20px;background:rgba(0,0,0,0.95);border:2px solid #0fc;color:#0fc;font-family:Orbitron;border-radius:12px;padding:16px;width:280px;display:none;max-height:calc(100% - 40px);overflow-y:auto">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;border-bottom:1px solid #0fc;padding-bottom:8px">
    <div style="font-size:14px;font-weight:bold" id="mapInfoTitle">Location Info</div>
    <button onclick="closeMapInfo()" style="background:transparent;border:none;color:#0fc;font-size:18px;cursor:pointer;padding:0;width:24px;height:24px">√ó</button>
  </div>
  <div id="mapInfoContent" style="font-size:11px;line-height:1.6"></div>
</div>

<div style="position:absolute;bottom:20px;right:20px;display:flex;flex-direction:column;gap:10px">
<button id="mapSatelliteToggle" style="background:rgba(0,0,0,0.8);border:2px solid #0fc;color:#0fc;font-family:Orbitron;font-size:11px;padding:8px 12px;cursor:pointer;border-radius:6px;width:50px;font-weight:bold">üõ∞Ô∏è</button>
<button id="mapRoadsToggle" class="active" style="background:rgba(0,0,0,0.8);border:2px solid #0fc;color:#0fc;font-family:Orbitron;font-size:11px;padding:8px 12px;cursor:pointer;border-radius:6px;width:50px;font-weight:bold">üõ£Ô∏è</button>
<div style="border-top:2px solid #0fc;margin:5px 0"></div>
<button id="mapZoomIn" style="background:rgba(0,0,0,0.8);border:2px solid #0fc;color:#0fc;font-family:Orbitron;font-size:20px;padding:10px 20px;cursor:pointer;border-radius:6px;width:50px">+</button>
<button id="mapZoomOut" style="background:rgba(0,0,0,0.8);border:2px solid #0fc;color:#0fc;font-family:Orbitron;font-size:20px;padding:10px 20px;cursor:pointer;border-radius:6px;width:50px">‚àí</button>
<div style="background:rgba(0,0,0,0.8);border:1px solid #0fc;color:#0fc;font-family:Orbitron;font-size:12px;padding:5px 10px;border-radius:6px;text-align:center" id="zoomLevel">Z: 14</div>
</div>
</div>
<div id="modeHud"><div id="modeTitle">Free Roam</div><div id="modeTimer">--:--</div><div id="modeInfo"></div></div>
<div id="explorationModeMsg" style="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.85);border:3px solid #667eea;border-radius:16px;padding:24px 48px;color:#ffffff;font-family:'Orbitron',sans-serif;font-size:28px;font-weight:700;z-index:1000;display:none;box-shadow:0 8px 32px rgba(0,0,0,0.5);text-align:center;letter-spacing:1px;cursor:pointer;pointer-events:auto">
Explore the area
</div>
<div id="navigationHud" style="position:fixed;top:100px;left:20px;background:rgba(0,255,136,0.9);border:2px solid #00ff88;border-radius:12px;padding:16px;color:#000;font-family:'Poppins',sans-serif;z-index:100;display:none;min-width:180px;box-shadow:0 4px 20px rgba(0,255,136,0.4)">
<div style="font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;opacity:0.8">üß≠ Navigation</div>
<div id="navDestination" style="font-size:14px;font-weight:700;margin-bottom:8px">Destination</div>
<div id="navDistance" style="font-size:24px;font-weight:700;margin-bottom:4px">--m</div>
<div id="navDirection" style="font-size:32px;text-align:center;margin-top:8px">‚Üë</div>
</div>
<div id="police">üíî 0/3</div>
<div id="poiInfo" style="position:fixed;top:20px;right:20px;background:rgba(0,0,0,0.85);border:2px solid #0fc;border-radius:12px;padding:16px;color:#0fc;font-family:Orbitron;z-index:100;display:none;min-width:200px;box-shadow:0 4px 20px rgba(0,255,200,0.3)">
<div id="poiIcon" style="font-size:32px;text-align:center;margin-bottom:8px">üè´</div>
<div id="poiName" style="font-size:14px;font-weight:bold;text-align:center;margin-bottom:4px">School</div>
<div id="poiCategory" style="font-size:11px;text-align:center;opacity:0.8;margin-bottom:8px">Education</div>
<div id="poiDistance" style="font-size:12px;text-align:center;padding-top:8px;border-top:1px solid rgba(0,255,200,0.3)">50m ahead</div>
</div>
<div class="floatMenuContainer" id="floatMenuContainer">
<!-- Top Row: Exploration and Environment -->
<div class="floatMenuRow">
<div class="floatMenu" id="exploreMenu">
<button class="floatBtn explore" id="exploreBtn"><span class="btnIcon">üåç</span><span class="btnText">Exploration</span></button>
<div class="floatItems">
<div class="floatItem" id="fDriving">üöó Driving Mode</div>
<div class="floatItem" id="fWalk">üö∂ Walk Mode</div>
<div class="floatItem" id="fDrone">üöÅ Drone Mode</div>
<div class="floatItem" id="fSpaceDirect">üåô Direct to Moon</div>
<div class="floatItem" id="fSpaceRocket">üöÄ Rocket to Moon</div>
<div style="border-top:1px solid #e2e8f0;margin:6px 0"></div>
<div class="floatItem" id="fNextCity">üìç New Location</div>
</div>
</div>

<div class="floatMenu" id="travelMenu">
<button class="floatBtn travel" id="travelBtn"><span class="btnIcon">üåø</span><span class="btnText">Environment</span></button>
<div class="floatItems">
<div class="floatItem" id="fSatellite">üõ∞Ô∏è Satellite</div>
<div class="floatItem" id="fRoads">üõ£Ô∏è Show Roads</div>
<div class="floatItem" id="fLandUse">üó∫Ô∏è Land Use</div>
<div class="floatItem" id="fTimeOfDay">‚òÄÔ∏è Day/Night</div>
<div class="floatItem" id="fClouds">‚òÅÔ∏è Clouds</div>
<div class="floatItem" id="fConstellations">‚ú® Constellations</div>
</div>
</div>
</div>

<!-- Bottom Row: Game Mode and Real Estate -->
<div class="floatMenuRow">
<div class="floatMenu" id="gameMenu">
<button class="floatBtn game" id="gameBtn"><span class="btnIcon">üéÆ</span><span class="btnText">Game Mode</span></button>
<div class="floatItems">
<div class="floatItem" id="fPolice">üöî Police</div>
<div class="floatItem" id="fTrack">üèÅ Record Track</div>
<div class="floatItem" id="fEraseTrack">üóëÔ∏è Erase Track</div>
<div class="floatItem" id="fBlockBuild">üß± Build Mode</div>
<div class="floatItem" id="fClearBlocks">üßπ Clear Blocks</div>
<div class="floatItem" id="fRespawn">üéØ Respawn</div>
<div class="floatItem" id="fRespawnRand">üé≤ Random Respawn</div>
</div>
</div>

<div class="floatMenu" id="realEstateMenu">
<button class="floatBtn realEstate" id="realEstateFloatBtn"><span class="btnIcon">üèòÔ∏è</span><span class="btnText">Real Estate</span></button>
<div class="floatItems">
<div class="floatItem" id="fRealEstate">üèòÔ∏è Real Estate</div>
<div class="floatItem" id="fHistoric">‚õ©Ô∏è Historic</div>
<div class="floatItem" id="fPOI">üìç POI</div>
<div class="floatItem" id="fLandUseRE">üó∫Ô∏è Land Use</div>
</div>
</div>
</div>
</div>
<div class="floatItem" id="fHome" style="display:none">üè† Menu</div>

<div id="memoryComposer">
<div class="memoryComposerTitle">Memory Marker</div>
<div id="memoryPersistenceHint" class="memoryComposerSub">Place a pin or flower with a short note (200 chars max).</div>
<div class="memoryTypeRow">
<button id="memoryTypePin" class="memoryTypeBtn active" type="button">üìç Pin</button>
<button id="memoryTypeFlower" class="memoryTypeBtn" type="button">üå∏ Flower</button>
</div>
<textarea id="memoryMessageInput" maxlength="200" placeholder="Leave a short memory note..."></textarea>
<div class="memoryComposerMeta">
<div id="memoryComposerStatus"></div>
<div id="memoryCharCount">0/200</div>
</div>
<div class="memoryActionRow">
<button id="memoryCancelBtn" class="memoryActionBtn" type="button">Cancel</button>
<button id="memoryPlaceBtn" class="memoryActionBtn" type="button">Place Marker</button>
<button id="memoryDeleteAllBtn" class="memoryActionBtn" type="button">Delete All</button>
</div>
</div>

<div id="memoryInfoPanel">
<div id="memoryInfoTitle">Memory Marker</div>
<div id="memoryInfoText"></div>
<div id="memoryInfoMeta"></div>
<div class="memoryInfoActions">
<button id="memoryInfoCloseBtn" class="memoryInfoBtn" type="button">Close</button>
<button id="memoryDeleteBtn" class="memoryInfoBtn" type="button">Remove Marker</button>
</div>
</div>

<button class="mainMenuBtn" id="mainMenuBtn">üè† Main Menu</button>
<button id="memoryFlowerFloatBtn" title="Place Flower Memory">üå∏</button>
<div id="buildModeIndicator">üß± Build Mode ON<br>Click to place blocks, Shift+Click to remove.<br>Press B to toggle.</div>
<div id="controlsTab"><div id="ctrlHeader">üõû Controls ‚ñº</div><div id="ctrlContent" class="hidden">
<div id="drivingControls">
<b>üöó Driving Mode:</b><br>
‚Ä¢ WASD/Arrows - Drive<br>
‚Ä¢ Space - Handbrake<br>
‚Ä¢ Ctrl - Boost<br>
‚Ä¢ Shift - Off-road mode<br>
‚Ä¢ C - Camera view<br>
‚Ä¢ F - Toggle walk mode<br>
‚Ä¢ 6 - Toggle drone mode<br>
‚Ä¢ M - Toggle map<br>
‚Ä¢ N - Next city<br>
‚Ä¢ B - Toggle build mode<br>
‚Ä¢ Click place block, Shift+Click remove
</div>
<div id="walkingControls" style="display:none">
<b>üö∂ Walking Mode:</b><br>
‚Ä¢ Arrows - Move<br>
‚Ä¢ WASD - Look around<br>
‚Ä¢ Space - Jump<br>
‚Ä¢ Shift - Run (2x speed)<br>
‚Ä¢ Right Click + Drag - Mouse look<br>
‚Ä¢ C - Camera view<br>
‚Ä¢ F - Toggle drive mode<br>
‚Ä¢ 6 - Toggle drone mode<br>
‚Ä¢ B - Toggle build mode<br>
‚Ä¢ Click place block, Shift+Click remove
</div>
<div id="droneControls" style="display:none">
<b>üöÅ Drone Mode:</b><br>
‚Ä¢ WASD - Move forward/back/strafe<br>
‚Ä¢ Arrows - Look around<br>
‚Ä¢ Mouse - Look around<br>
‚Ä¢ Space - Fly up<br>
‚Ä¢ Ctrl/Shift - Fly down<br>
‚Ä¢ 6 - Exit drone mode<br>
‚Ä¢ B - Toggle build mode<br>
‚Ä¢ Click place block, Shift+Click remove
</div>
<div id="rocketControls" style="display:none">
<b>üöÄ Rocket Mode:</b><br>
‚Ä¢ Arrow Keys - Steer rocket (yaw/pitch)<br>
‚Ä¢ Space - Thrust / Boost<br>
‚Ä¢ Shift - Brake / Decelerate<br>
‚Ä¢ LAND ON ... Button - Land when in range
</div>
</div></div>

<!-- Real Estate System -->
<button id="realEstateBtn" title="Toggle Real Estate">üè†</button>
<div id="propertyPanel">
  <div class="panel-header">
    <div>
      <div class="panel-title">Properties</div>
      <div style="font-size:10px;opacity:0.9;margin-top:2px" id="dataSourceLabel">Source: Demo Data</div>
    </div>
    <button class="panel-close" onclick="closePropertyPanel()">√ó</button>
  </div>
  <div style="padding:12px 16px;background:#f1f5f9;border-bottom:2px solid #e2e8f0;cursor:pointer" onclick="togglePropertyFilters()">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <span id="propertyCount" style="font-size:11px;color:#64748b;font-weight:600">0 Properties</span>
        <span style="font-size:11px;color:#cbd5e1"> ‚Ä¢ </span>
        <span id="propertySource" style="font-size:11px;color:#64748b;font-weight:600">Demo</span>
      </div>
      <div id="filterToggleIcon" style="font-size:16px;color:#667eea">‚ñº</div>
    </div>
  </div>
  <div id="propertyFilters" style="padding:16px;border-bottom:2px solid #e2e8f0;background:#f8fafc;display:none">
    <div style="margin-bottom:12px">
      <label style="display:block;font-size:11px;font-weight:600;color:#64748b;margin-bottom:6px">Property Type</label>
      <div style="display:flex;gap:8px">
        <button id="filterAll" class="property-type-btn active" data-type="all" style="flex:1;background:#667eea;border:none;border-radius:8px;padding:8px;color:#ffffff;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.2s">
          All
        </button>
        <button id="filterBuy" class="property-type-btn" data-type="sale" style="flex:1;background:#e2e8f0;border:none;border-radius:8px;padding:8px;color:#64748b;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.2s">
          Buy
        </button>
        <button id="filterRent" class="property-type-btn" data-type="rent" style="flex:1;background:#e2e8f0;border:none;border-radius:8px;padding:8px;color:#64748b;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.2s">
          Rent
        </button>
      </div>
    </div>
    <div style="margin-bottom:12px">
      <label style="display:block;font-size:11px;font-weight:600;color:#64748b;margin-bottom:6px">
        Search Radius: <span id="radiusValue">1.0 km</span>
      </label>
      <input type="range" id="radiusSlider" min="0.5" max="5" step="0.5" value="1" style="width:100%;cursor:pointer">
    </div>
    <div style="margin-bottom:12px">
      <label style="display:block;font-size:11px;font-weight:600;color:#64748b;margin-bottom:6px">Sort By</label>
      <select id="sortSelect" style="width:100%;background:#ffffff;border:2px solid #e2e8f0;border-radius:8px;padding:8px;font-size:12px;cursor:pointer">
        <option value="distance">Nearest First</option>
        <option value="price-low">Price: Low to High</option>
        <option value="price-high">Price: High to Low</option>
        <option value="beds">Most Bedrooms</option>
        <option value="sqft">Largest Square Footage</option>
      </select>
    </div>
    <div style="display:flex;gap:8px">
      <button id="refreshProperties" style="flex:1;background:#667eea;border:none;border-radius:8px;padding:8px;color:#ffffff;font-size:11px;font-weight:600;cursor:pointer">
        üîÑ Refresh
      </button>
      <button id="clearPropertyFilter" style="flex:1;background:#64748b;border:none;border-radius:8px;padding:8px;color:#ffffff;font-size:11px;font-weight:600;cursor:pointer">
        ‚úï Clear Nav
      </button>
    </div>
  </div>
  <div class="panel-content" id="propertyList"></div>
</div>

<!-- Historic Sites System -->
<button id="historicBtn" title="Toggle Historic Sites" style="position:fixed;bottom:150px;right:20px;width:56px;height:56px;background:linear-gradient(135deg,#f59e0b,#d97706);border:none;border-radius:50%;color:#ffffff;font-size:24px;cursor:pointer;box-shadow:0 8px 24px rgba(245,158,11,0.4);transition:all 0.2s;z-index:100;display:none">‚õ©Ô∏è</button>
<div id="historicPanel" style="position:fixed;top:20px;right:20px;width:380px;max-height:80vh;background:rgba(255,255,255,0.98);border:none;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,0.2);z-index:110;display:none;overflow:hidden;backdrop-filter:blur(10px);flex-direction:column">
  <div class="panel-header" style="background:linear-gradient(135deg,#f59e0b,#d97706)">
    <div class="panel-title">Historic Sites</div>
    <button class="panel-close" onclick="closeHistoricPanel()">√ó</button>
  </div>
  <div style="padding:12px 16px;background:#fef3c7;font-size:11px;color:#78350f;font-weight:600;border-bottom:2px solid #f59e0b">
    <span id="historicCount">0 Sites</span> ‚Ä¢ From OpenStreetMap
  </div>
  <div class="panel-content" id="historicList"></div>
</div>

<div id="propertyModal">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-title" id="modalTitle"></div>
      <button class="modal-close" onclick="closeModal()">√ó</button>
    </div>
    <div class="modal-body" id="modalBody"></div>
  </div>
</div>

<div id="debugOverlay" style="position:fixed;bottom:20px;right:200px;background:rgba(0,0,0,0.8);color:#0f0;font-family:monospace;font-size:11px;padding:10px 14px;border-radius:8px;z-index:200;display:none;line-height:1.6;pointer-events:none;white-space:pre"></div>
<div id="perfPanel" style="position:fixed;top:20px;right:20px;background:rgba(2,6,23,0.85);color:#38bdf8;font-family:monospace;font-size:11px;padding:10px 12px;border-radius:8px;z-index:210;display:none;line-height:1.45;white-space:pre;pointer-events:none;border:1px solid rgba(56,189,248,0.4);min-width:270px;max-width:340px"></div>
<div id="loading"><div class="spinner"></div><div id="loadText">Loading...</div></div>
<div id="pauseScreen"><div class="pauseTitle">PAUSED</div><button class="pauseBtn" id="resumeBtn">Resume</button><button class="pauseBtn" id="restartBtn">Restart</button><button class="pauseBtn" id="menuBtn">Main Menu</button></div>
<div id="resultScreen"><div class="resultBox"><div id="resultTitle">Complete!</div><div id="resultStats"></div><button class="pauseBtn" id="againBtn">Play Again</button><button class="pauseBtn" id="freeBtn">Free Roam</button><button class="pauseBtn" id="resMenuBtn">Menu</button></div></div>
<div id="caughtScreen"><div class="caughtBox"><div class="caughtTitle">üöî BUSTED!</div><div class="caughtText">You've been caught!</div><button class="caughtBtn" id="caughtBtn">Try Again</button></div></div>
<script type="module" src="js/bootstrap.js?v=37"></script>
</body></html>
